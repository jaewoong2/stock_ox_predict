# Fargate 비용 계산 (서울 리전 기준)

## 현재 사양: 512 CPU (0.5 vCPU), 1024MB (1GB) 메모리

### Fargate On-Demand 요금:
- vCPU: $0.04656/시간
- 메모리: $0.00511/GB/시간

### Fargate Spot 요금 (평균 70% 할인):
- vCPU: $0.01397/시간 (약 70% 할인)
- 메모리: $0.00153/GB/시간 (약 70% 할인)

## 비용 시나리오 분석:

### 기존 구성 (1개 Spot 태스크):
- 월간 시간: 730시간
- vCPU 비용: 0.5 × $0.01397 × 730 = $5.10
- 메모리 비용: 1 × $0.00153 × 730 = $1.12
- **월 총 비용: $6.22**

### 새로운 구성 (2개 태스크 - 1 On-Demand + 1 Spot):
- **On-Demand 태스크 (1개):**
  - vCPU: 0.5 × $0.04656 × 730 = $17.00
  - 메모리: 1 × $0.00511 × 730 = $3.73
  - 소계: $20.73

- **Spot 태스크 (1개):**
  - vCPU: 0.5 × $0.01397 × 730 = $5.10
  - 메모리: 1 × $0.00153 × 730 = $1.12
  - 소계: $6.22

- **기본 2개 태스크 월 총 비용: $26.95**

### Auto Scaling 시 추가 비용:
- 3개 태스크 시: $26.95 + $6.22 (Spot) = $33.17
- 4개 태스크 시: $26.95 + $12.44 (2×Spot) = $39.39

## 비용 최적화 옵션들:

### 옵션 1: 풀 Spot 구성 (위험 감수)
```terraform
# 2개 모두 Spot으로 실행 (더 저렴하지만 위험)
capacity_provider_strategy {
  capacity_provider = "FARGATE_SPOT"
  weight            = 100
  base              = 2  # 2개 모두 Spot
}
```
- **월 비용: $12.44** (기존 대비 2배)
- 위험: 두 태스크 모두 동시 종료 가능성

### 옵션 2: 스케줄 기반 혼합 (추천)
```terraform
# 평일 피크 시간만 On-Demand, 나머지는 Spot
# 현재 구성에서 스케줄링으로 비용 절약
```
- **평균 월 비용: $18-22** (시간대별 조정)

### 옵션 3: 더 작은 인스턴스 사용
```terraform
# CPU/메모리 사양 다운그레이드
cpu    = "256"  # 0.25 vCPU
memory = "512"  # 0.5GB
```
- **50% 비용 절약**: 각 태스크당 절반 비용
