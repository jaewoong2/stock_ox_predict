# OX Universe - κµ¬ν„ TODO

## μ™„λ£λ μ‘μ—… β…

### Phase 1: κΈ°λ³Έ μΈν”„λΌ λ° λ°μ΄ν„°λ² μ΄μ¤
- [x] ν”„λ΅μ νΈ κµ¬μ΅° λ¶„μ„ μ™„λ£
- [x] μ”κµ¬μ‚¬ν•­ λ¬Έμ„ λ¶„μ„ μ™„λ£
- [x] μ•„ν‚¤ν…μ² μ„¤κ³„ λ¶„μ„ μ™„λ£
- [x] **ν”„λ΅μ νΈ ν΄λ” κµ¬μ΅° μ •λ¦¬ λ° κΈ°λ³Έ μ„¤μ •**
  - [x] requirements.txt μ—…λ°μ΄νΈ (JWT, OAuth, λ°°μΉ λ“± ν•„μ ν¨ν‚¤μ§€ μ¶”κ°€)
  - [x] .env.example νμΌ μƒμ„± (μ™„μ „ν• ν™κ²½λ³€μ μ„¤μ •)
- [x] **SQLAlchemy λ¨λΈ μ •μ (crypto μ¤ν‚¤λ§ κΈ°λ°)**
  - [x] μ‚¬μ©μ λ¨λΈ (OAuth μ§€μ›)
  - [x] μ„Έμ… λ° μΆ…λ© λ¨λΈ
  - [x] μμΈ΅ λ° μ •μ‚° λ¨λΈ
  - [x] ν¬μΈνΈ λ° λ¦¬μ›λ“ λ¨λΈ
- [x] **Pydantic μ¤ν‚¤λ§ μ •μ (λ¨λ“  Request/Response)**
  - [x] μΈμ¦ κ΄€λ ¨ μ¤ν‚¤λ§
  - [x] μ‚¬μ©μ, μ„Έμ…, μμΈ΅ μ¤ν‚¤λ§
  - [x] μ •μ‚°, ν¬μΈνΈ, λ¦¬μ›λ“ μ¤ν‚¤λ§
- [x] **Repository ν¨ν„΄ κµ¬ν„ (Pydantic μ‘λ‹µ)**
  - [x] BaseRepository ν΄λμ¤ (Pydantic μ‘λ‹µ λ³΄μ¥)
  - [x] UserRepository (OAuth μ§€μ›)
  - [x] SessionRepository & ActiveUniverseRepository
  - [x] PredictionRepository & UserDailyStatsRepository
  - [x] PointsRepository (λ©±λ“±μ„± λ³΄μ¥)
  - [x] RewardsRepository (μΈλ²¤ν† λ¦¬ & κµν™)
  - [x] **Pylance νƒ€μ… μ—λ¬ μμ • μ™„λ£**
    - [x] SQLAlchemy Column νƒ€μ… μ—λ¬ ν•΄κ²°
    - [x] BaseRepository μ λ„¤λ¦­ νƒ€μ… μ μ•½ μμ •
    - [x] μ•μ „ν• λ¨λΈ μ†μ„± μ ‘κ·Ό ν¨ν„΄ μ μ©
    - [x] Optional νƒ€μ… μ²λ¦¬ λ° null-safety λ³΄μ¥

## μ§„ν–‰ μ¤‘μΈ μ‘μ—… π§

- β… **ν¬μΈνΈ μ‹μ¤ν… λ° λ¦¬μ›λ“ μ‹μ¤ν… κµ¬ν„ μ™„λ£** (2025-08-26)

## λ€κΈ° μ¤‘μΈ μ‘μ—… π“‹

### Phase 2: μ„λΉ„μ¤ κ³„μΈµ κµ¬ν„
- [x] **μΈμ¦ μ‹μ¤ν… κµ¬ν„ (JWT + OAuth)** β…
  - [x] JWT ν† ν° κ΄€λ¦¬ μ„λΉ„μ¤ (HS256)
  - [x] OAuth μΈμ¦ μ„λΉ„μ¤ (Google & Kakao)
  - [x] μΈμ¦ λ―Έλ“¤μ›¨μ–΄
  - [x] μ‚¬μ©μ μΈμ¦ μ„λΉ„μ¤
- [x] **μ„Έμ… κ΄€λ¦¬ μ‹μ¤ν… κµ¬ν„** β…
  - [x] μ„Έμ… μ„λΉ„μ¤ κµ¬ν„
  - [x] ν™μ„± μ λ‹λ²„μ¤ μ„λΉ„μ¤ κµ¬ν„
- [x] **μμΈ΅ μ‹μ¤ν… κµ¬ν„** β…
  - [x] μμΈ΅ μ„λΉ„μ¤ κµ¬ν„
  - [x] μμΈ΅ μ μ¶/μμ •/μ·¨μ† κ²€μ¦ λ΅μ§
  - [x] μΌμΌ ν†µκ³„ κ΄€λ¦¬ μ„λΉ„μ¤ μ—°λ™
  - [x] μ •μ‚° λ³΄μ΅° λ΅μ§ (lock/bulk update/stats)
  - [x] **μμΈ΅ λΌμ°ν„° μ™„μ „ κµ¬ν„** (prediction_router.py μ™„λ£)
    - [x] κΈ°λ³Έ CRUD μ‘μ—… (μ μ¶/μμ •/μ·¨μ†)
    - [x] μ‚¬μ©μ μμΈ΅ νμ¤ν† λ¦¬ μ΅°ν
    - [x] μΆ…λ©λ³„ μμΈ΅ μ΅°ν
    - [x] μΌμΌ ν†µκ³„ λ° μ”μ•½ μ΅°ν
    - [x] λ‚¨μ€ μμΈ΅ μ¬λ΅― μ΅°ν λ° μ¦κ°€
    - [x] κ΄€λ¦¬μμ© μ •μ‚° μ²λ¦¬ μ—”λ“ν¬μΈνΈ (μ κΈ/μΌκ΄„μ²λ¦¬/λ€κΈ°λ©λ΅)
    - [x] **κ°€κ²© μ΅°ν μ‹μ¤ν… κµ¬ν„** (PriceService μ™„λ£)
      - [x] μ‹¤μ‹κ°„ μΆ…λ© κ°€κ²© μ΅°ν (Yahoo Finance API μ—°λ™)
      - [x] μ¤λμ μ λ‹λ²„μ¤ μ „μ²΄ κ°€κ²© μΌκ΄„ μ΅°ν
      - [x] EOD(μ¥ λ§κ°) κ°€κ²© μ΅°ν λ° κ²€μ¦
      - [x] μμΈ΅ κ²°κ³Όμ™€ μ‹¤μ  κ°€κ²© λΉ„κµ κΈ°λ¥
    - [x] **μ •μ‚° κ²€μ¦ μ‹μ¤ν… κµ¬ν„** (SettlementService μ™„λ£)
      - [x] μλ™ μ •μ‚° λ° κ°€κ²© κ²€μ¦
      - [x] μμΈ΅ μ„±κ³µ/μ‹¤ν¨ νμ • λ΅μ§
      - [x] μλ™ μ •μ‚° κΈ°λ¥ (κ΄€λ¦¬μμ©)
      - [x] μ •μ‚° μ”μ•½ λ° ν†µκ³„ μ κ³µ
      - [x] λΉ„μ •μƒ κ°€κ²© λ°μ΄ν„° μ²λ¦¬ (VOID μ²λ¦¬)
- [x] **λ°°μΉ μ‹μ¤ν… κµ¬ν„** β…
  - [x] λ°°μΉ μ„λΉ„μ¤ κµ¬ν„ (Universe & Session κ΄€λ¦¬)
  - [x] SQS κΈ°λ° μ›ν¬ν”λ΅μ° μ¤μΌ€μ¤„λ§
  - [x] μΌμΌ λ°°μΉ μ‘μ—… μλ™ν™” (μ λ‹λ²„μ¤ μƒμ„± β†’ μμΈ΅ μ‹μ‘ β†’ μμΈ΅ λ§κ°)
- [x] **ν¬μΈνΈ μ‹μ¤ν… κµ¬ν„** β…
  - [x] ν¬μΈνΈ μ„λΉ„μ¤ κµ¬ν„ (λ©±λ“±μ„± λ³΄μ¥)
  - [x] ν¬μΈνΈ κ±°λ λ° λ¬΄κ²°μ„± κ΄€λ¦¬
  - [x] μμΈ΅ μμλ£ μ°¨κ° λ° λ³΄μƒ μ§€κΈ‰ ν†µν•©
  - [x] μ‚¬μ©μ ν¬μΈνΈ μ”μ•΅/λ‚΄μ—­ μ΅°ν API
  - [x] μ‹ κ· κ°€μ… λ³΄λ„μ¤ ν¬μΈνΈ μ§€κΈ‰
- [x] **λ¦¬μ›λ“ μ‹μ¤ν… κµ¬ν„** β…
  - [x] λ¦¬μ›λ“ μ„λΉ„μ¤ κµ¬ν„
  - [x] μΈλ²¤ν† λ¦¬ κ΄€λ¦¬ μ„λΉ„μ¤
  - [x] κµν™ μ²λ¦¬ μ„λΉ„μ¤
  - [x] λ¦¬μ›λ“ μΉ΄νƒλ΅κ·Έ λ° κµν™ API

### Phase 3: API κ³„μΈµ κµ¬ν„
- [x] **λΌμ°ν„° κµ¬ν„ (Auth & User)** β…
  - [x] μ‚¬μ©μ μΈμ¦ λΌμ°ν„°
  - [x] μ‚¬μ©μ κ΄€λ¦¬ λΌμ°ν„° (ν”„λ΅ν•„, κ²€μƒ‰, ν†µκ³„)
  - [x] λ΅μ»¬ νμ›κ°€μ… μ κ±° (OAuth μ „μ© κ°€μ…)
  - [x] λ΅μ»¬ λ΅κ·ΈμΈ μ κ±° (OAuth μ „μ© λ΅κ·ΈμΈ)
  - [x] μ„Έμ… κ΄€λ¦¬ λΌμ°ν„° β…
  - [x] μμΈ΅ μ μ¶ λΌμ°ν„° (μΈμ¦ μ‚¬μ©μ μ „μ©) β…
  - [x] μ λ‹λ²„μ¤ κ΄€λ¦¬ λΌμ°ν„° β…
  - [x] λ°°μΉ κ΄€λ¦¬ λΌμ°ν„° β… (Universe/Session λ°°μΉ, SQS μ›ν¬ν”λ΅μ° μ¤μΌ€μ¤„λ§)
  - [x] ν¬μΈνΈ κ΄€λ¦¬ λΌμ°ν„° β…
  - [x] λ¦¬μ›λ“ κµν™ λΌμ°ν„° β…
- [x] **λ°°μΉ μ²λ¦¬ μ‹μ¤ν…** β…
  - [x] λ°°μΉ μ›μ»¤ κµ¬ν„ (SQS κΈ°λ°)
  - [x] μΌμΌ μ›ν¬ν”λ΅μ° μλ™ν™”
  - [ ] EOD λ°μ΄ν„° μμ§‘ μ„λΉ„μ¤
  - [ ] μ •μ‚° μ„λΉ„μ¤ κµ¬ν„

### Phase 4: ν†µν•© λ° ν…μ¤νΈ
- [x] **μμ΅΄μ„± μ£Όμ… μ„¤μ • μ™„λ£** β…
  - [x] μ„λΉ„μ¤ μ»¨ν…μ΄λ„ μ„¤μ • (containers.py)
  - [x] Repository μμ΅΄μ„± λ“±λ΅
  - [x] μ „μ²΄ μ„λΉ„μ¤ μμ΅΄μ„± ν†µν•© (Universe, Session, Batch, Prediction)
- [x] **FastAPI μ•± ν†µν•©** β…
  - [x] λΌμ°ν„° λ“±λ΅ (main.py) β€” auth, users, predictions, prices, settlement, session, universe, batch ν¬ν•¨
  - [x] μμ΅΄μ„± μ£Όμ… wiring μ„¤μ • (μƒ λΌμ°ν„°λ“¤ ν¬ν•¨)
  - [ ] λ―Έλ“¤μ›¨μ–΄ μ„¤μ •
  - [x] CORS λ° λ³΄μ• μ„¤μ •
- [x] **ν…μ¤νΈ μ½”λ“ μ‘μ„±** β…
  - [ ] Repository ν…μ¤νΈ
  - [x] μ„λΉ„μ¤ ν…μ¤νΈ (Universe, Session, Batch)
  - [x] API μ—”λ“ν¬μΈνΈ ν…μ¤νΈ (Auth, User, Universe, Session, Batch)
  - [x] λ΅μ»¬ νμ›κ°€μ… ν…μ¤νΈ μ κ±° (OAuth Only μ •μ±… λ°μ)
  - [x] λ΅μ»¬ λ΅κ·ΈμΈ ν…μ¤νΈ μ κ±° (OAuth Only μ •μ±… λ°μ)

## λ‹¤μμ— ν•΄μ•Ό ν•  κµ¬μ²΄μ  μ‘μ—…

1. **μ„λΉ„μ¤ κ³„μΈµ κµ¬ν„**
   - κ° λ„λ©”μΈλ³„ μ„λΉ„μ¤ ν΄λμ¤ κµ¬ν„
   - λΉ„μ¦λ‹μ¤ λ΅μ§ κµ¬ν„
   - νΈλμ­μ… κ΄€λ¦¬

## μ£Όμ” κ³ λ ¤μ‚¬ν•­

- β… λ¨λ“  Request/Responseλ” Pydantic BaseModel μ‚¬μ©
- β… Repository μ‘λ‹µμ€ ORMμ΄ μ•„λ‹ Pydantic μ¤ν‚¤λ§ μ‚¬μ©
- β… Pylance μ—λ¬ λ°©μ§€λ¥Ό μ„ν• νƒ€μ… νν… (SQLAlchemy Column νƒ€μ… μ—λ¬ ν•΄κ²°)
- β… **νΈλμ­μ… λ¬΄κ²°μ„± λ³΄μ¥** - λ¨λ“  Repositoryμ—μ„ μ μ ν• commit/rollback μ²λ¦¬ μ™„λ£
- β… **μμ΅΄μ„± μ£Όμ… μ™„μ„±** - μƒ λΌμ°ν„°λ“¤ ν¬ν•¨ν• μ™„μ „ν• wiring μ„¤μ •
- β… **κ΄€μ‹¬μ‚¬ λ¶„λ¦¬** - Router λ λ²¨μ—μ„ λ„λ©”μΈλ³„ κΉ”λ”ν• λ¶„λ¦¬ μ™„λ£
- λΉ„μ¦λ‹μ¤ λ΅μ§μ€ @docs/ λ¬Έμ„ κΈ°λ°μΌλ΅ κµ¬ν„
- λ©±λ“±μ„± λ³΄μ¥ (ν¬μΈνΈ μ‹μ¤ν…)
- κ°€μ…/λ΅κ·ΈμΈμ€ OAuth μ „μ© (λ΅μ»¬ μ΄λ©”μΌ/λΉ„λ°€λ²νΈ λΉ„ν™μ„±ν™”)
- OAuth λ΅κ·ΈμΈ μ‹ λ‹‰λ„¤μ„ λ³€κ²½ κ°μ§€ λ° μ¤‘λ³µ νν”Ό λ™κΈ°ν™”

## κµ¬ν„ μ™„λ£ ν„ν™©

### β… **Phase 1: κΈ°λ³Έ μΈν”„λΌ λ° λ°μ΄ν„°λ² μ΄μ¤** - μ™„λ£
- **SQLAlchemy λ¨λΈ**: λ¨λ“  λ„λ©”μΈ λ¨λΈ μ™„λ£ (User, Session, Prediction, Points, Rewards)
- **Pydantic μ¤ν‚¤λ§**: μ™„μ „ν• Request/Response μ¤ν‚¤λ§ μ •μ
- **Repository ν¨ν„΄**: μ™„μ „ κµ¬ν„λ λ°μ΄ν„° μ•΅μ„Έμ¤ κ³„μΈµ + νƒ€μ… μ•μ „μ„±
  - BaseRepository (μ λ„¤λ¦­ CRUD + Pydantic λ³΄μ¥)
  - UserRepository (OAuth μ§€μ›)
  - SessionRepository & ActiveUniverseRepository 
  - PredictionRepository & UserDailyStatsRepository
  - PointsRepository (λ©±λ“±μ„± λ³΄μ¥)
  - RewardsRepository (μΈλ²¤ν† λ¦¬ & κµν™ κ΄€λ¦¬)
  - **λ¨λ“  Pylance νƒ€μ… μ—λ¬ ν•΄κ²°** (SQLAlchemy Column νƒ€μ… νΈν™μ„±, μ λ„¤λ¦­ νƒ€μ… μ μ•½, Optional μ²λ¦¬)

### π§ **ν„μ¬ μ§„ν–‰ μ¤‘**: Phase 1.5 - λ°μ΄ν„°λ² μ΄μ¤ μ¤ν‚¤λ§ μƒμ„±
- Alembic λ§μ΄κ·Έλ μ΄μ… μ¤ν¬λ¦½νΈ
- PostgreSQL crypto μ¤ν‚¤λ§ μƒμ„±
- ν…μ΄λΈ” λ° μ μ•½μ΅°κ±΄ μ„¤μ •

### β… **μ™„λ£λ μ‘μ—…**: Phase 2-4 - μ„λΉ„μ¤/API/ν…μ¤νΈ κµ¬ν„ μ™„λ£
- **UniverseService**: μ¤λμ μΆ…λ© κ΄€λ¦¬ μ™„λ£ (μ¤λ μΆ…λ© μ΅°ν, νΉμ • λ‚ μ§ μΆ…λ© μ΅°ν, μΆ…λ© μ—…μ„νΈ)
- **SessionService**: μ„Έμ… μƒνƒ κ΄€λ¦¬ μ™„λ£ (ν„μ¬ μ„Έμ…, μμΈ΅ μ‹μ‘/μΆ…λ£, μ •μ‚° μƒνƒ μ „ν™)  
- **PredictionService**: μμΈ΅ μ‹μ¤ν… μ™„λ£ (μμΈ΅ μ μ¶/μμ •/μ·¨μ†, ν†µκ³„ μ΅°ν, μ •μ‚° κ΄€λ ¨)
- **BatchService**: λ°°μΉ μ‹μ¤ν… μ™„λ£ (SQS μ›ν¬ν”λ΅μ°, μΌμΌ μλ™ν™”, Universe/Session κ΄€λ¦¬)
- **API λΌμ°ν„°**: Universe, Session, Batch λΌμ°ν„° κµ¬ν„ λ° ν†µν•©
- **ν…μ¤νΈ μ½”λ“**: λ¨λ“  λΌμ°ν„° λ° μ„λΉ„μ¤μ— λ€ν• ν¬κ΄„μ μΈ λ‹¨μ„ ν…μ¤νΈ μ™„λ£

## μµκ·Ό μ™„λ£ μ‘μ—… (2025-08-26) β…

### 1. Router λ¦¬ν©ν† λ§ μ™„λ£ 
- [x] **prediction_router.py λ¶„λ¦¬ μ‘μ—… μ™„λ£**
  - [x] `price_router.py` μƒμ„± - κ°€κ²© μ΅°ν κ΄€λ ¨ μ—”λ“ν¬μΈνΈ λ¶„λ¦¬
    - μ‹¤μ‹κ°„ κ°€κ²© μ΅°ν (`/prices/current/{symbol}`)
    - μ λ‹λ²„μ¤ κ°€κ²© μ΅°ν (`/prices/universe/{trading_day}`)
    - EOD κ°€κ²© μ΅°ν (`/prices/eod/{symbol}/{trading_day}`)
    - κ΄€λ¦¬μμ© μ •μ‚° κ°€κ²© κ²€μ¦ (`/prices/admin/validate-settlement/{trading_day}`)
    - μμΈ΅ κ²°κ³Ό λΉ„κµ (`/prices/admin/compare-prediction`)
  - [x] `settlement_router.py` μƒμ„± - μ •μ‚° κ΄€λ ¨ μ—”λ“ν¬μΈνΈ λ¶„λ¦¬
    - μλ™ μ •μ‚° (`/admin/settlement/settle-day/{trading_day}`)
    - μ •μ‚° μ”μ•½ (`/admin/settlement/summary/{trading_day}`)
    - μλ™ μ •μ‚° (`/admin/settlement/manual-settle`)
  - [x] `prediction_router.py` μ •λ¦¬ - μμΈ΅ κ΄€λ ¨ κΈ°λ¥λ§ μ μ§€
  - [x] `main.py` μ—…λ°μ΄νΈ - μƒ λΌμ°ν„°λ“¤ λ“±λ΅
  - [x] κ΄€μ‹¬μ‚¬ λ¶„λ¦¬ λ° μ½”λ“ κ°€λ…μ„± ν–¥μƒ

**λ¶„λ¦¬λ λΌμ°ν„° κµ¬μ΅°:**
- `/predictions/*` - μμΈ΅ CRUD λ° κ΄€λ¦¬ (prediction_router.py)
- `/prices/*` - κ°€κ²© μ΅°ν λ° κ²€μ¦ (price_router.py)
- `/admin/settlement/*` - μ •μ‚° μ²λ¦¬ (settlement_router.py)

### 2. Settlement Service λ° μμ΅΄μ„± μ£Όμ… λ¬Έμ  ν•΄κ²° μ™„λ£
- [x] **StatusEnumμ— VOID μƒνƒ μ¶”κ°€** (`myapi/models/prediction.py`)
  - μ •μ‚° μ‹ κ°€κ²© λ°μ΄ν„° λ¬Έμ λ΅ μΈν• μμΈ΅ λ¬΄ν¨ν™” μ²λ¦¬ μ§€μ›
- [x] **PredictionStatusμ— VOID μƒνƒ μ¶”κ°€** (`myapi/schemas/prediction.py`)
  - μ¤ν‚¤λ§μ™€ λ¨λΈ κ°„ μƒνƒ μΌκ΄€μ„± λ³΄μ¥
- [x] **PredictionRepository λ©”μ„λ“ μ‹κ·Έλ‹μ² μμ •**
  - `get_predictions_by_symbol_and_date()`: status_filter νλΌλ―Έν„° Optionalλ΅ λ³€κ²½
  - `count_predictions_by_date()`, `count_predictions_by_date_and_status()` λ©”μ„λ“ μ¶”κ°€
- [x] **SettlementService λ©”μ„λ“ νΈμ¶ μμ •**
  - `get_symbols_for_day` β†’ `get_universe_for_date` λ³€κ²½
  - StatusEnum vs PredictionStatus νƒ€μ… νΌμ© λ¬Έμ  ν•΄κ²°
- [x] **μμ΅΄μ„± μ£Όμ… wiring μ„¤μ • μ—…λ°μ΄νΈ** (`myapi/containers.py`)
  - μƒ λΌμ°ν„°λ“¤(`price_router`, `settlement_router`) wiring μ„¤μ •μ— μ¶”κ°€
  - 'Provide' object μ—λ¬ ν•΄κ²°

### 3. λ°μ΄ν„°λ² μ΄μ¤ νΈλμ­μ… κ΄€λ¦¬ μ „λ©΄ κ°μ„  μ™„λ£
**λ¬Έμ **: Repositoryμ—μ„ `db.flush()`λ§ μκ³  `db.commit()`μ΄ λ„λ½λμ–΄ λ°μ΄ν„° μμ†μ„± λ¬Έμ  λ°μƒ

**ν•΄κ²°λ Repository νμΌλ“¤:**

#### 3.1 **active_universe_repository.py** (3κ³³ μμ •)
- `add_symbol_to_universe()`: flush ν›„ commit μ¶”κ°€
- `remove_symbol_from_universe()`: flush β†’ commit λ³€κ²½  
- `clear_universe_for_date()`: flush β†’ commit λ³€κ²½

#### 3.2 **points_repository.py** (1κ³³ μμ •)
- `process_points_transaction()`: flush ν›„ commit μ¶”κ°€

#### 3.3 **rewards_repository.py** (7κ³³ μμ •)
- `add_inventory_item()`: flush ν›„ commit μ¶”κ°€
- `update_inventory_stock()`: flush β†’ commit λ³€κ²½
- `reserve_inventory()`: flush β†’ commit λ³€κ²½ (2κ³³)
- `release_reservation()`: flush β†’ commit λ³€κ²½
- `create_redemption()`: flush ν›„ commit μ¶”κ°€
- `process_redemption()`: flush β†’ commit λ³€κ²½
- `delete_inventory_item()`: flush β†’ commit λ³€κ²½

#### 3.4 **prediction_repository.py** (5κ³³ μμ •)
- `lock_predictions_for_settlement()`: flush β†’ commit λ³€κ²½
- `bulk_update_predictions_status()`: commit/flush μμ„ μμ •
- `get_or_create_user_daily_stats()`: flush ν›„ commit μ¶”κ°€
- `increment_predictions_made()`: flush β†’ commit λ³€κ²½
- `increase_max_predictions()`: flush β†’ commit λ³€κ²½

**νΈλμ­μ… κ΄€λ¦¬ ν¨ν„΄ ν™•λ¦½:**
- β… **BaseRepository**: create(), update(), delete()μ— μ μ ν• commit/rollback κµ¬ν„λ¨
- β… **κ°λ³„ Repository**: λΉ„μ¦λ‹μ¤ λ΅μ§ λ©”μ„λ“λ“¤μ λ„λ½λ commit λ¨λ‘ μ¶”κ°€
- β… **λ°μ΄ν„° μμ†μ„±**: λ¨λ“  λ°μ΄ν„° λ³€κ²½ μ‘μ—…μ΄ μ¬λ°”λ¥΄κ² μ»¤λ°‹λμ–΄ DBμ— μμ†ν™”
- β… **νΈλμ­μ… μΌκ΄€μ„±**: flush β†’ commit μμ„μ™€ rollback μ²λ¦¬ μΌκ΄€μ„± ν™•λ³΄

### 4. μΊμ‹ μ „λµ κ°μ„  μ μ• (PriceService)
- [x] **ν„μ¬ κ°€κ²© μΊμ‹ λ¶„μ„ μ™„λ£**
  - κΈ°μ΅΄: 60μ΄ κ³ μ • TTL
  - μ μ•: μ¥ μƒνƒλ³„ μ°¨λ“± μΊμ‹ (OPEN: 30μ΄, PRE/AFTER: 5λ¶„, CLOSED: 30λ¶„)
  - μ‹¤μ‹κ°„μ„±κ³Ό API νΈμ¶ μµμ ν™” κ· ν• ν™•λ³΄

### 5. μ „μ²΄ μ‹μ¤ν… μ•μ •μ„± ν™•λ³΄
- [x] **Import ν…μ¤νΈ μ„±κ³µ**: λ¨λ“  service, repository μ„ν¬νΈ μ •μƒ μ‘λ™
- [x] **API μ—”λ“ν¬μΈνΈ μ •μƒν™”**: Settlement κ΄€λ ¨ APIλ“¤μ΄ μ¬λ°”λ¥΄κ² μ‘λ™
- [x] **νƒ€μ… μ•μ „μ„±**: Pylance νƒ€μ… μ—λ¬λ“¤ ν•΄κ²° μ™„λ£
- [x] **μ½”λ“ κ°€λ…μ„±**: 700μ¤„ λ‹¨μΌ νμΌ β†’ κ΄€μ‹¬μ‚¬λ³„ λ¶„λ¦¬λ΅ μ μ§€λ³΄μμ„± ν–¥μƒ

## μµκ·Ό μ™„λ£ μ‘μ—… (2025-08-26) β…

### 6. ν¬μΈνΈ λ° λ¦¬μ›λ“ μ‹μ¤ν… μ™„μ „ κµ¬ν„ μ™„λ£
- [x] **ν¬μΈνΈ μ‹μ¤ν… μ „λ©΄ κµ¬ν„** (`point_service.py`, `point_router.py`)
  - [x] λ©±λ“±μ„± λ³΄μ¥ ν¬μΈνΈ νΈλμ­μ… (ref_id κΈ°λ° μ¤‘λ³µ λ°©μ§€)
  - [x] ν¬μΈνΈ μ λ¦½/μ°¨κ°/μ΅°ν κΈ°λ¥ μ™„μ„±
  - [x] μμΈ΅ μμλ£ μ°¨κ° λ° μ •λ‹µ λ³΄μƒ μ§€κΈ‰ λ΅μ§
  - [x] μ‚¬μ©μ ν¬μΈνΈ μ”μ•΅/λ‚΄μ—­/μ¬μ •μ”μ•½ API μ—”λ“ν¬μΈνΈ
  - [x] κ΄€λ¦¬μμ© ν¬μΈνΈ μ΅°μ • λ° ν†µκ³„ API

- [x] **λ¦¬μ›λ“ μ‹μ¤ν… μ „λ©΄ κµ¬ν„** (`reward_service.py`, `reward_router.py`)
  - [x] λ¦¬μ›λ“ μΉ΄νƒλ΅κ·Έ μ΅°ν λ° μƒν’ κ΄€λ¦¬
  - [x] ν¬μΈνΈ κµν™ μ²λ¦¬ (μ¬κ³  ν™•μΈ, ν¬μΈνΈ μ°¨κ°, κµν™ κΈ°λ΅)
  - [x] μ‚¬μ©μ κµν™ λ‚΄μ—­ μ΅°ν API
  - [x] κ΄€λ¦¬μμ© μΈλ²¤ν† λ¦¬ κ΄€λ¦¬ λ° κµν™ μ²λ¦¬ API

- [x] **κΈ°μ΅΄ μ„λΉ„μ¤ ν¬μΈνΈ μ—°λ™ ν†µν•©**
  - [x] `prediction_service.py`: μμΈ΅ μμλ£ μ°¨κ° (10ν¬μΈνΈ) λ° μ·¨μ† μ‹ ν™λ¶
  - [x] `settlement_service.py`: μ •λ‹µ μμΈ΅ λ³΄μƒ μ§€κΈ‰ (100ν¬μΈνΈ) λ° VOID ν™λ¶
  - [x] `user_service.py`: ν¬μΈνΈ κ΄€λ ¨ μ‚¬μ©μ κΈ°λ¥ μ¶”κ°€ (μ”μ•΅ μ΅°ν, λ‚΄μ—­, μ¬μ • μ”μ•½)
  - [x] `auth_service.py`: μ‹ κ· κ°€μ… λ³΄λ„μ¤ ν¬μΈνΈ μ§€κΈ‰ (1000ν¬μΈνΈ)

- [x] **API μ—”λ“ν¬μΈνΈ μ™„μ„±**
  - [x] `/users/me/points/*` : μ‚¬μ©μ ν¬μΈνΈ κ΄€λ ¨ μ—”λ“ν¬μΈνΈ
  - [x] `/points/*` : ν¬μΈνΈ κ΄€λ¦¬ API (μ‚¬μ©μ/κ΄€λ¦¬μ)
  - [x] `/rewards/*` : λ¦¬μ›λ“ κµν™ API (μ‚¬μ©μ/κ΄€λ¦¬μ)

- [x] **μμ΅΄μ„± μ£Όμ… λ° λΌμ°ν„° ν†µν•©**
  - [x] `containers.py`: ν¬μΈνΈ/λ¦¬μ›λ“ μ„λΉ„μ¤ μμ΅΄μ„± λ“±λ΅
  - [x] `main.py`: μƒ λΌμ°ν„°λ“¤ λ“±λ΅ λ° wiring μ„¤μ •

**ν†µν•©λ ν¬μΈνΈ κ²½μ  μ‹μ¤ν…:**
- β… **μ‹ κ· κ°€μ…**: 1000ν¬μΈνΈ λ³΄λ„μ¤
- β… **μμΈ΅ μμλ£**: 10ν¬μΈνΈ μ°¨κ° (μ·¨μ† μ‹ ν™λ¶)
- β… **μ •λ‹µ λ³΄μƒ**: 100ν¬μΈνΈ μ§€κΈ‰
- β… **λ¦¬μ›λ“ κµν™**: ν¬μΈνΈλ΅ μƒν’ κµν™
- β… **νΈλμ­μ… μ•μ „μ„±**: λ©±λ“±μ„± λ° rollback λ³΄μ¥

### π“‹ **λ‹¤μ λ‹¨κ³„**: EOD λ°μ΄ν„° μμ§‘ λ° μ •μ‚° μλ™ν™”
ν¬μΈνΈ λ° λ¦¬μ›λ“ μ‹μ¤ν…κΉμ§€ μ™„μ„±λμ–΄ μ „μ²΄ μ‚¬μ©μ μ—¬μ •μ΄ μ™„λ£λμ—μΌλ―€λ΅, μ΄μ  EOD κ°€κ²© λ°μ΄ν„° μμ§‘κ³Ό μλ™ μ •μ‚° μ‹μ¤ν… κµ¬ν„μ΄ λ‹¤μ μ°μ„ μμ„μ…λ‹λ‹¤.
